# Author : isaac
# Email  : mkalafsaz@gmail.com
# Time   : Wed 26 Nov 2025 | 23:32:09

import requests
import os


def get_python_repos(username):
    url = f"https://api.github.com/users/{username}/repos?per_page=100"
    repos = []
    page = 1

    while True:
        response = requests.get(f"{url}&page={page}")

        if response.status_code != 200:
            print(
                f"‚ùå Error fetching data for {username}: {response.status_code}")
            return []

        data = response.json()
        if not data:
            break  # No more pages

        for repo in data:
            if repo.get("language") == "Python":
                repos.append(repo["name"])

        page += 1

    return repos


def save_repos(username, repos):
    filename = f"{username}.txt"
    with open(filename, "w") as f:
        for repo in repos:
            f.write(repo + "\n")

    print(f"‚úÖ Saved Python repos for {username} ‚Üí {filename}")


def main():
    users_file = "users.txt"

    if not os.path.exists(users_file):
        print(
            "‚ùå users.txt not found! Create a file with one GitHub username per line."
        )
        return

    with open(users_file, "r") as f:
        usernames = [line.strip() for line in f if line.strip()]

    for username in usernames:
        print(f"üîç Fetching repos for {username}...")
        repos = get_python_repos(username)

        if repos:
            save_repos(username, repos)
        else:
            print(f"‚ö†Ô∏è No Python repos found for {username}.\n")


if __name__ == "__main__":
    main()
